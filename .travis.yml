language: php

php:
  - 5.4

before_script:
  - node -v
  - curl --version
  - sqlite3 --version
  - composer install
  - wget https://github.com/n1k0/casperjs/archive/1.1-beta3.tar.gz -O /tmp/casper.tar.gz
  - tar -xvf /tmp/casper.tar.gz
  - export PATH=$PATH:$PWD/casperjs-1.1-beta3/bin/
  - phantomjs --version
  - casperjs --version
  - nohup php -S localhost:8080 > out.log 2>&1 &
  - sleep 5
  - curl -L http://localhost:8080
script:
  - whoami
  - cd tests
  - casperjs test *.js --server="http://localhost:8080" --log-level="debug" --verbose
  - ls -al
